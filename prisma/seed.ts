import { PrismaClient } from '@prisma/client'
import bcrypt from 'bcryptjs'

const prisma = new PrismaClient()

async function main() {
  console.log('üå± D√©but du seeding...')

  // Cr√©er un utilisateur admin
  const hashedPassword = await bcrypt.hash('admin123', 12)
  const admin = await prisma.user.upsert({
    where: { email: 'admin@polux.fr' },
    update: {},
    create: {
      name: 'Administrateur Pol-UX',
      email: 'admin@polux.fr',
      username: 'admin',
      password: hashedPassword,
      role: 'ADMIN',
    },
  })

  // Cr√©er quelques utilisateurs de test
  const user1 = await prisma.user.upsert({
    where: { email: 'user1@polux.fr' },
    update: {},
    create: {
      name: 'Jean Dupont',
      email: 'user1@polux.fr',
      username: 'jean_dupont',
      password: await bcrypt.hash('password123', 12),
      role: 'CONTRIBUTOR',
    },
  })

  const user2 = await prisma.user.upsert({
    where: { email: 'user2@polux.fr' },
    update: {},
    create: {
      name: 'Marie Martin',
      email: 'user2@polux.fr',
      username: 'marie_martin',
      password: await bcrypt.hash('password123', 12),
      role: 'EXPLORER',
    },
  })

  // Cr√©er quelques initiatives de test
  const initiative1 = await prisma.initiative.create({
    data: {
      title: 'Nettoyage du Parc de la Villette',
      description: 'Grande op√©ration de nettoyage du parc avec la communaut√© locale. Venez nombreux pour rendre notre parc plus propre !',
      type: 'EVENT',
      latitude: 48.8907,
      longitude: 2.3878,
      address: '211 Avenue Jean Jaur√®s',
      city: 'Paris',
      postalCode: '75019',
      startDate: new Date('2024-06-15'),
      endDate: new Date('2024-06-15'),
      website: 'https://example.com',
      contactEmail: 'contact@example.com',
      contactPhone: '01 23 45 67 89',
      authorId: user1.id
    },
  })

  const initiative2 = await prisma.initiative.create({
    data: {
      title: 'Association √âco-Citoyens Lyon',
      description: 'Association locale d√©di√©e √† la promotion de pratiques √©cologiques dans la r√©gion lyonnaise.',
      type: 'ASSOCIATION',
      latitude: 45.7578,
      longitude: 4.8320,
      address: '15 Rue de la R√©publique',
      city: 'Lyon',
      postalCode: '69001',
      website: 'https://eco-citoyens-lyon.fr',
      contactEmail: 'contact@eco-citoyens-lyon.fr',
      authorId: user2.id
    },
  })

  const initiative3 = await prisma.initiative.create({
    data: {
      title: 'Projet de Jardin Partag√©',
      description: 'Cr√©ation d\'un jardin partag√© dans le quartier pour promouvoir l\'agriculture urbaine et la biodiversit√©.',
      type: 'PROJECT',
      latitude: 43.2965,
      longitude: 5.3698,
      address: '25 Boulevard Michelet',
      city: 'Marseille',
      postalCode: '13008',
      startDate: new Date('2024-07-01'),
      endDate: new Date('2024-12-31'),
      contactEmail: 'jardin@example.com',
      authorId: user1.id
    },
  })

  // Cr√©er quelques posts de forum
  const post1 = await prisma.forumPost.create({
    data: {
      title: 'Comment r√©duire ses d√©chets au quotidien ?',
      content: 'Je cherche des conseils pratiques pour r√©duire mes d√©chets m√©nagers. Quelles sont vos astuces ?',
      category: 'TIPS',
      authorId: user1.id
    },
  })

  const post2 = await prisma.forumPost.create({
    data: {
      title: '√âv√©nement √©cologique √† Paris',
      content: 'Il y a un grand √©v√©nement √©cologique qui se pr√©pare √† Paris. Qui est int√©ress√© pour y participer ?',
      category: 'EVENTS',
      authorId: user2.id
    },
  })

  // Cr√©er quelques commentaires
  await prisma.forumComment.create({
    data: {
      content: 'Je recommande le compostage ! C\'est tr√®s efficace pour r√©duire les d√©chets organiques.',
      authorId: user2.id,
      postId: post1.id,

    },
  })

  await prisma.forumComment.create({
    data: {
      content: 'Moi aussi je suis int√©ress√© ! Quand est-ce que √ßa se passe ?',
      authorId: user1.id,
      postId: post2.id,

    },
  })

  // Cr√©er quelques conseils √©cologiques
  const tip1 = await prisma.tip.create({
    data: {
      title: 'Remplacer les bouteilles en plastique',
      content: 'Utilisez une gourde r√©utilisable en inox ou en verre. Cela permet d\'√©conomiser des centaines de bouteilles en plastique par an !',
      category: 'WASTE_REDUCTION',
      authorId: user1.id
    },
  })

  const tip2 = await prisma.tip.create({
    data: {
      title: '√âconomiser l\'√©nergie avec les LED',
      content: 'Remplacez vos ampoules classiques par des LED. Elles consomment jusqu\'√† 80% moins d\'√©nergie et durent plus longtemps.',
      category: 'ENERGY_SAVING',
      authorId: user2.id
    },
  })

  const tip3 = await prisma.tip.create({
    data: {
      title: 'Privil√©gier les transports en commun',
      content: 'Pour vos trajets quotidiens, privil√©giez les transports en commun, le v√©lo ou la marche. C\'est bon pour la plan√®te et pour votre sant√© !',
      category: 'TRANSPORT',
      authorId: user1.id
    },
  })

  // Cr√©er quelques articles de test
  const article1 = await prisma.article.create({
    data: {
      title: 'L\'impact du changement climatique sur la biodiversit√© fran√ßaise',
      content: `Le changement climatique repr√©sente l'un des plus grands d√©fis de notre √©poque, avec des cons√©quences directes sur la biodiversit√© fran√ßaise.

Les temp√©ratures moyennes en France ont augment√© de 1,7¬∞C depuis 1900, un rythme plus rapide que la moyenne mondiale. Cette hausse affecte directement les √©cosyst√®mes et les esp√®ces qui les habitent.

**Les impacts observ√©s :**

1. **Modification des cycles de vie** : De nombreuses esp√®ces voient leurs cycles de reproduction et de migration perturb√©s par les changements de temp√©rature.

2. **D√©placement des habitats** : Les esp√®ces migrent vers le nord ou en altitude pour trouver des conditions climatiques favorables.

3. **Perturbation des interactions** : Les relations entre esp√®ces (pollinisation, pr√©dation) sont d√©s√©quilibr√©es.

**Solutions locales :**

- Cr√©ation de corridors √©cologiques
- Protection des zones humides
- R√©duction des √©missions de gaz √† effet de serre
- √âducation et sensibilisation

La France, avec sa riche biodiversit√©, a un r√¥le crucial √† jouer dans la protection de l'environnement. Chaque action locale compte dans cette lutte globale.`,
      excerpt: 'Analyse approfondie des cons√©quences du r√©chauffement climatique sur les √©cosyst√®mes fran√ßais et les solutions pour y faire face.',
      category: 'CLIMATE_CHANGE',
      imageUrl: 'https://images.unsplash.com/photo-1569163136547-3c23a60a1c2d?w=800&h=400&fit=crop',
      authorId: user1.id,
      publishedAt: new Date('2024-01-15')
    },
  })

  const article2 = await prisma.article.create({
    data: {
      title: 'Les √©nergies renouvelables : l\'avenir de la production √©lectrique',
      content: `Les √©nergies renouvelables repr√©sentent aujourd'hui la solution la plus viable pour d√©carboner notre production √©lectrique et lutter contre le changement climatique.

**Les diff√©rentes sources d'√©nergies renouvelables :**

1. **√ânergie solaire** : La France dispose d'un excellent potentiel solaire, particuli√®rement dans le sud du pays. Les panneaux photovolta√Øques peuvent √™tre install√©s sur les toits, les parkings ou en centrales au sol.

2. **√ânergie √©olienne** : L'√©olien terrestre et offshore offre un potentiel consid√©rable. La France poss√®de le deuxi√®me gisement √©olien d'Europe.

3. **√ânergie hydraulique** : Avec ses nombreux cours d'eau, la France b√©n√©ficie d'une hydro√©lectricit√© mature et fiable.

4. **Biomasse** : La valorisation des d√©chets organiques et du bois √©nergie contribue √† la transition √©nerg√©tique.

**Avantages des √©nergies renouvelables :**

- R√©duction des √©missions de CO2
- Ind√©pendance √©nerg√©tique
- Cr√©ation d'emplois locaux
- Prix de l'√©lectricit√© plus stable
- D√©centralisation de la production

**D√©fis √† relever :**

- Intermittence de certaines sources
- Besoin de stockage
- Acceptabilit√© sociale
- Co√ªts d'investissement initiaux

La transition vers les √©nergies renouvelables est en marche et s'acc√©l√®re. Chaque citoyen peut contribuer en installant des panneaux solaires, en choisissant un fournisseur d'√©nergie verte ou en investissant dans des projets citoyens.`,
      excerpt: 'D√©couvrez comment les √©nergies renouvelables r√©volutionnent la production √©lectrique et contribuent √† la transition √©cologique.',
      category: 'RENEWABLE_ENERGY',
      imageUrl: 'https://images.unsplash.com/photo-1509391366360-2e959784a276?w=800&h=400&fit=crop',
      authorId: admin.id,
      publishedAt: new Date('2024-02-20')
    },
  })

  const article3 = await prisma.article.create({
    data: {
      title: 'L\'√©conomie circulaire : un mod√®le √©conomique durable',
      content: `L'√©conomie circulaire propose un nouveau mod√®le √©conomique qui s'oppose au mod√®le lin√©aire traditionnel "extraire, produire, consommer, jeter".

**Les principes de l'√©conomie circulaire :**

1. **√âcoconception** : Concevoir des produits en pensant √† leur fin de vie d√®s le d√©part
2. **R√©duction des d√©chets** : Minimiser la production de d√©chets √† chaque √©tape
3. **R√©utilisation** : Donner une seconde vie aux produits et composants
4. **Recyclage** : Transformer les d√©chets en nouvelles ressources
5. **R√©cup√©ration d'√©nergie** : Valoriser √©nerg√©tiquement les d√©chets non recyclables

**Exemples concrets en France :**

- **L'industrie textile** : Recyclage des v√™tements en nouvelles fibres
- **Le secteur du b√¢timent** : R√©utilisation des mat√©riaux de d√©construction
- **L'agriculture** : Compostage et m√©thanisation des d√©chets organiques
- **L'√©lectronique** : R√©paration et recyclage des composants

**B√©n√©fices pour l'environnement :**

- R√©duction de l'extraction de ressources naturelles
- Diminution des √©missions de gaz √† effet de serre
- Limitation de la pollution
- Pr√©servation de la biodiversit√©

**B√©n√©fices √©conomiques :**

- Cr√©ation d'emplois locaux
- R√©duction des co√ªts de production
- Innovation et comp√©titivit√©
- R√©silience face aux crises

L'√©conomie circulaire n'est pas seulement un concept, c'est une r√©alit√© qui se d√©veloppe partout en France. Chaque citoyen peut participer en privil√©giant les produits durables, en r√©parant plut√¥t qu'en jetant, et en triant ses d√©chets.`,
      excerpt: 'D√©couvrez comment l\'√©conomie circulaire transforme notre mod√®le √©conomique pour un avenir plus durable.',
      category: 'CIRCULAR_ECONOMY',
      imageUrl: 'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800&h=400&fit=crop',
      authorId: user1.id,
      publishedAt: new Date('2024-03-10')
    },
  })

  console.log('‚úÖ Seeding termin√© !')
  console.log(`üë§ Admin cr√©√©: ${admin.email}`)
  console.log(`üë• Utilisateurs cr√©√©s: ${user1.email}, ${user2.email}`)
  console.log(`üó∫Ô∏è Initiatives cr√©√©es: ${initiative1.title}, ${initiative2.title}, ${initiative3.title}`)
  console.log(`üí¨ Posts cr√©√©s: ${post1.title}, ${post2.title}`)
  console.log(`üí° Conseils cr√©√©s: ${tip1.title}, ${tip2.title}, ${tip3.title}`)
  console.log(`üì∞ Articles cr√©√©s: ${article1.title}, ${article2.title}, ${article3.title}`)
}

main()
  .catch((e) => {
    console.error('‚ùå Erreur lors du seeding:', e)
    process.exit(1)
  })
  .finally(async () => {
    await prisma.$disconnect()
  })
